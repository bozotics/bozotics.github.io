<!DOCTYPE html>
<!--
	Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
	Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
	Free for personal and commercial use under the MIT license
	https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
	<head>
		<meta charset="utf-8" />

		<!-- begin _includes/seo.html -->
		<title>General Information | Transcendence</title>
		<meta name="description" content="Camera Microprocessor" />

		<meta property="og:type" content="article" />
		<meta property="og:locale" content="en_US" />
		<meta property="og:site_name" content="Transcendence" />
		<meta property="og:title" content="General Information" />
		<meta
			property="og:url"
			content="https://bozo.infocommsociety.com/open/cam/general/"
		/>

		<meta property="og:description" content="Camera Microprocessor" />

		<meta
			property="article:published_time"
			content="2020-05-02T08:00:00+08:00"
		/>

		<meta
			property="article:modified_time"
			content="2020-07-10T11:57:40+08:00"
		/>

		<link
			rel="canonical"
			href="https://bozo.infocommsociety.com/open/cam/general/"
		/>

		<script type="application/ld+json">
			{
				"@context": "https://schema.org",

				"@type": "Person",
				"name": null,
				"url": "https://bozo.infocommsociety.com/"
			}
		</script>

		<!-- end _includes/seo.html -->

		<link
			href="/feed.xml"
			type="application/atom+xml"
			rel="alternate"
			title="Transcendence Feed"
		/>

		<!-- https://t.co/dKP3o1e -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<script>
			document.documentElement.className =
				document.documentElement.className.replace(/\bno-js\b/g, "") + " js ";
		</script>

		<!-- For all browsers -->
		<link rel="stylesheet" href="/assets/css/main.css" />

		<!--[if IE]>
			<style>
				/* old IE unsupported flexbox fixes */
				.greedy-nav .site-title {
					padding-right: 3em;
				}
				.greedy-nav button {
					position: absolute;
					top: 0;
					right: 0;
					height: 100%;
				}
			</style>
		<![endif]-->

		<!-- start custom head snippets -->

		<style>
			ul.visible-links li.masthead__menu-item a[href="/open/intro/"]:before {
				transform: scaleX(1);
			}

			ul.hidden-links li.masthead__menu-item a[href="/open/intro/"] {
				color: #fff;
				background: #0092ca;
			}
		</style>

		<!-- insert favicons. use https://realfavicongenerator.net/ -->
		<link rel="icon" href="/assets/images/eagle ver 2.1.3.1-lowres.jpg" />

		<!-- end custom head snippets -->
	</head>

	<body class="layout--single">
		<nav class="skip-links">
			<h2 class="screen-reader-text">Skip links</h2>
			<ul>
				<li>
					<a href="#site-nav" class="screen-reader-shortcut"
						>Skip to primary navigation</a
					>
				</li>
				<li>
					<a href="#main" class="screen-reader-shortcut">Skip to content</a>
				</li>
				<li>
					<a href="#footer" class="screen-reader-shortcut">Skip to footer</a>
				</li>
			</ul>
		</nav>

		<!--[if lt IE 9]>
			<div class="notice--danger align-center" style="margin: 0;">
				You are using an <strong>outdated</strong> browser. Please
				<a href="https://browsehappy.com/">upgrade your browser</a> to improve
				your experience.
			</div>
		<![endif]-->

		<div class="masthead">
			<div class="masthead__inner-wrap">
				<div class="masthead__menu">
					<nav id="site-nav" class="greedy-nav">
						<a class="site-logo" href="/"
							><img
								loading="lazy"
								src="/assets/images/eagle%20ver%202.1.3.1-transparent-lowres.png"
								alt=""
						/></a>

						<a class="site-title" href="/">
							Transcendence
							<span class="site-subtitle"
								>The fine line between innovation and insanity</span
							>
						</a>
						<ul class="visible-links">
							<li class="masthead__menu-item">
								<a href="/about/">About</a>
							</li>
							<li class="masthead__menu-item">
								<a href="/open/intro/">Open</a>
							</li>
							<li class="masthead__menu-item">
								<a href="/lightweight/intro/">Lightweight</a>
							</li>
							<li class="masthead__menu-item">
								<a href="/rescue/intro/">Rescue</a>
							</li>
							<li class="masthead__menu-item">
								<a href="/blog/">Blog</a>
							</li>
							<li class="masthead__menu-item">
								<a href="/contact/">Contact</a>
							</li>
							<li class="masthead__menu-item">
								<a href="/resources/">Resources</a>
							</li>
						</ul>

						<button class="search__toggle" type="button">
							<span class="visually-hidden">Toggle search</span>
							<svg
								class="icon"
								width="16"
								height="16"
								xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 15.99 16"
							>
								<path
									d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z"
									transform="translate(-.01)"
								></path>
							</svg>
						</button>

						<button class="greedy-nav__toggle hidden" type="button">
							<span class="visually-hidden">Toggle menu</span>
							<div class="navicon"></div>
						</button>
						<ul class="hidden-links hidden"></ul>
					</nav>
				</div>
			</div>
		</div>

		<div class="initial-content">
			<div id="main" role="main">
				<div class="sidebar sticky">
					<nav class="nav__list">
						<input id="ac-toc" name="accordion-toc" type="checkbox" />
						<label for="ac-toc">Toggle menu</label>
						<ul class="nav__items">
							<li>
								<a href="/open/intro/"
									><span class="nav__sub-title">Introduction</span></a
								>
							</li>

							<li>
								<a href="/open/mech/"
									><span class="nav__sub-title">Mechanical</span></a
								>

								<ul>
									<li><a href="/open/mech/general/">General Info</a></li>

									<li><a href="/open/mech/drive/">Drive System</a></li>

									<li><a href="/open/mech/mirror/">Mirror</a></li>

									<li><a href="/open/mech/dribbler/">Dribbler</a></li>

									<li><a href="/open/mech/assorted/">Assorted Parts</a></li>
								</ul>
							</li>

							<li>
								<a href="/open/elec/"
									><span class="nav__sub-title">Electronics</span></a
								>

								<ul>
									<li><a href="/open/elec/design/">Design</a></li>

									<li><a href="/open/elec/circuits/">Circuits</a></li>

									<li><a href="/open/elec/components/">Components</a></li>

									<li><a href="/open/elec/selection/">Selection Process</a></li>

									<li><a href="/open/elec/soldering/">Soldering</a></li>

									<li><a href="/open/elec/history/">History</a></li>
								</ul>
							</li>

							<li>
								<a href="/open/cam/"
									><span class="nav__sub-title">Camera</span></a
								>

								<ul>
									<li>
										<a href="/open/cam/general/" class="active">General Info</a>
									</li>

									<li><a href="/open/cam/track/">Tracking Algorithm</a></li>

									<li><a href="/open/cam/gui/">GUI</a></li>

									<li><a href="/open/cam/communication/">Communication</a></li>
								</ul>
							</li>

							<li>
								<a href="/open/strat/"
									><span class="nav__sub-title">Strategy</span></a
								>
							</li>

							<li>
								<a href="/open/debug/"
									><span class="nav__sub-title">Debugging</span></a
								>
							</li>

							<li>
								<a href="/open/afi/"><span class="nav__sub-title">AFI</span></a>
							</li>
						</ul>
					</nav>
				</div>

				<article
					class="page"
					itemscope
					itemtype="https://schema.org/CreativeWork"
				>
					<meta itemprop="headline" content="General Information" />
					<meta itemprop="description" content="Camera Microprocessor" />
					<meta itemprop="datePublished" content="2020-05-02T08:00:00+08:00" />
					<meta itemprop="dateModified" content="2020-07-10T11:57:40+08:00" />

					<div class="page__inner-wrap">
						<header>
							<h1 id="page-title" class="page__title" itemprop="headline">
								General Information
							</h1>
						</header>

						<section class="page__content" itemprop="text">
							<aside class="sidebar__right sticky">
								<nav class="toc">
									<header>
										<h4 class="nav__title">
											<i class="fas fa-cog"></i> General Information
										</h4>
									</header>
									<ul class="toc__menu">
										<li>
											<a href="#camera-microprocessor">Camera Microprocessor</a>
											<ul>
												<li>
													<a href="#raspberry-pi-rpi-3b"
														>Raspberry Pi (RPi) 3B</a
													>
												</li>
												<li>
													<a href="#alternatives-considered"
														>Alternatives considered</a
													>
												</li>
											</ul>
										</li>
										<li>
											<a href="#camera">Camera</a>
											<ul>
												<li><a href="#rpi-camera-v1">RPi camera V1</a></li>
												<li>
													<a href="#alternatives-considered-1"
														>Alternatives considered</a
													>
												</li>
											</ul>
										</li>
										<li>
											<a href="#operating-system-os">Operating System (OS)</a>
											<ul>
												<li><a href="#arch-linux">Arch Linux</a></li>
												<li>
													<a href="#alternatives-considered-2"
														>Alternatives considered</a
													>
												</li>
											</ul>
										</li>
										<li>
											<a href="#programming-language">Programming Language</a>
										</li>
										<li>
											<a href="#libraries-used">Libraries Used</a>
											<ul>
												<li><a href="#opencv">“OpenCv”</a></li>
												<li>
													<a href="#libssh-modified">“LibSSH” (modified)</a>
												</li>
												<li><a href="#threading">“Threading”</a></li>
												<li><a href="#qt5">“QT5”</a></li>
											</ul>
										</li>
									</ul>
								</nav>
							</aside>

							<h2 id="camera-microprocessor">Camera Microprocessor</h2>

							<h3 id="raspberry-pi-rpi-3b">Raspberry Pi (RPi) 3B</h3>

							<p>
								This model of RPi is the choice of our microprocessor for the
								camera system of our robot. The computational power of the RPi
								to its price is higher than other SBCs. Furthermore, the RPi has
								a well established community online which had been helpful when
								we faced issues with it. Aside from RPi 3B, we have also
								considered other alternatives.
							</p>

							<h3 id="alternatives-considered">Alternatives considered</h3>

							<p><ins>Raspberry Pi 4B</ins></p>

							<p>
								The newer model of RPi was released in June 2019. By then, we
								had a few RPi 3Bs in our possession, thus it will be a waste to
								invest in new RPi 4Bs. Furthermore, since the RPi had just been
								released, there might be hardware or software issues. We did not
								want to take the risk of running into such problems, so we took
								the safe route of sticking with RPi 3B.
							</p>

							<p><ins>Other SBCs</ins></p>

							<p>
								The $99 price tag of a <strong>Jetson Nano</strong> is more than
								3 times that of a RPi. Furthermore, we were unsure of its
								performance and our ability to get the it working to our
								standards. Other than the Jetson Nano, we took the
								<strong>Asus Tinkerboard</strong> into consideration and
								experimented with it. However, our preliminary testing of the
								board gave us bad results as the images captured from the camera
								were distorted after passing through the graphics pipeline. This
								was made worse by the fact that there wasn’t much online support
								and documentation for this board. While these SBCs could
								potentially have greater performance benefits, but chose settle
								on RPi which was “good enough” so that we can invest more time
								in other parts of the robot.
							</p>

							<p><ins>RPi Compute Module</ins></p>

							<p>
								While the compute module could potentially make way for a more
								compact design of our robot, we did not use it due to the
								unreliability of our PCB during the time of consideration (when
								we first started designing PCBs). Also, similar to the RPi 4B,
								we did not want to put the existing RPi 3Bs in our possession to
								waste so we did not convert to compute modules.
							</p>

							<h2 id="camera">Camera</h2>

							<h3 id="rpi-camera-v1">RPi camera V1</h3>

							<p>
								Currently, we are using RPi camera V1 which is able to capture
								frames at 640p and 90 FPS. Due to the inferior onboard camera
								sensor compared to its successor, we had to tune various camera
								parameters such as white balance, constrast, brightness, etc to
								exxagerate certain colours on the field to compensate for the
								lower quality images.
							</p>

							<h3 id="alternatives-considered-1">Alternatives considered</h3>

							<p><ins>RPi camera V2</ins></p>

							<p>
								While this model of the RPi camera boasts a better sensor, the
								FPS cap for full FOV streaming was a dealbreaker. We tried to
								circumvent this problem by modifying the raspiraw library but to
								no avail. This plan was then abandoned as it was taking longer
								than expected and we found an alternative solution to this
								problem - adjusting the paramenters of V1.
							</p>

							<p><ins>OpenMV</ins></p>

							<p>
								OpenMV was an enticing product for us as it had everything in
								place, from a GUI to the algorithms itself. However, we decided
								not to use it as it was extremely restrictive in terms of the
								algorithms. Furthermore, in the aspect of performance, OpenMV
								does not fare any better than the RPi.
							</p>

							<p><ins>ArduCam</ins></p>

							<h2 id="operating-system-os">Operating System (OS)</h2>

							<h3 id="arch-linux">Arch Linux</h3>

							<p>
								With Arch, the startup time of our RPi is around 12 seconds and
								if no program is running on the RPi, the CPU and RAM utilisation
								is close to 0%. To achieve that we only installed essential
								components and run the RPi headless (we do have an installed
								user interface which was used during set up). This was how we
								set up our RPi with Arch Linux:
							</p>

							<ol>
								<li>
									Write
									<a
										href="http://os.archlinuxarm.org/os/ArchLinuxARM-rpi-3-latest.tar.gz"
										>Arch Linux Arm for Raspberry Pi 3</a
									>
									image into an SD card
								</li>
								<li>Set-up autologin</li>
								<li>
									Install Desktop environment preferably a lightweight one
									(LXDE) due to the limited RAM of the rpi (Optional)
								</li>
								<li>Obtain SSH public keys on both devices (laptop and rpi)</li>
								<li>
									Set up DHCP server on rpi (Allow RPi to assign the laptop a
									static IP address)
								</li>
								<li>
									Install OpenCV with optimization (ARM NEON and VFPV3 enabled)
								</li>
								<li>
									Also install the following packages: libssh and raspicam
									(modified)
								</li>
							</ol>

							<h3 id="alternatives-considered-2">Alternatives considered</h3>

							<p><ins>Raspbian (Lite)</ins></p>

							<p>
								Initially when we first started using RPi, we used Raspbian.
								However, we thought the 30 seconds startup was too long for us
								and at any point of time there were many background processes
								running, thus draining the limited computational resources.
							</p>

							<p><ins>Diet Pi</ins></p>

							<p><ins>Buildroot</ins></p>

							<p><ins>Bare Metal</ins></p>

							<h2 id="programming-language">Programming Language</h2>

							<p>
								All of our code is written in C++ as it is more suited for our
								use of running programs in realtime. In previous years, we used
								Python but aftering uncovering problems such as slower
								computational speed and the Global Interpreter Lock, we made a
								switch to C++.
							</p>

							<h2 id="libraries-used">Libraries Used</h2>

							<p>
								These are some libraries that we used in the development of our
								camera program and GUI.
							</p>

							<h3 id="opencv">
								“<code class="language-plaintext highlighter-rouge">OpenCv</code
								>”
							</h3>

							<p>
								<code class="language-plaintext highlighter-rouge">OpenCV</code>
								was used for image transformation and processing as it contains
								a wide range of well documented computer vision algorithms. We
								built the
								<code class="language-plaintext highlighter-rouge">OpenCV</code>
								with all available optimisations for RPi. With these
								optimisations, the performance increased by 400 percent (Most
								functions are 4 times faster).
							</p>

							<h3 id="libssh-modified">
								“<code class="language-plaintext highlighter-rouge">LibSSH</code
								>” (modified)
							</h3>

							<p><a href="google.com">link to source code</a></p>

							<p>
								<code class="language-plaintext highlighter-rouge">LibSSH</code>
								was used to access the files in the raspi from the laptop. It
								played an essential part in the automation of sending files,
								running programs and running commands on the terminal of the RPi
								in our GUI.
							</p>

							<h3 id="threading">
								“<code class="language-plaintext highlighter-rouge"
									>Threading</code
								>”
							</h3>

							<p>
								Task parallelisation was achieved with this library. We used
								atomic variables and conditions to control and synchronise
								multiple threads.
								<code class="language-plaintext highlighter-rouge"
									>Threading</code
								>
								in C++ allowed us to achieve true task parallelisation instead
								of rapid task switching in Python.
							</p>

							<h3 id="qt5">
								“<code class="language-plaintext highlighter-rouge">QT5</code>”
							</h3>

							<p>
								Our GUI was created using this library - from the design to
								functions.
							</p>

							<details>
								<summary>todo</summary>

								<ul>
									<li>
										camera+raspi
										<ul>
											<li>vs other SBC (jetson nano, tinkerboard, odroid)</li>
											<li>vs compute module</li>
											<li>vs raspi 4</li>
											<li>SD card woes + backup problems</li>
											<li>
												initial confusions, python opencv era of reinstalling
												100000 times
											</li>
											<li>
												OS considered
												<ul>
													<li>raspbian (lite)</li>
													<li>dietpi</li>
													<li>arch</li>
													<li>buildroot and why we haven’t done that yet</li>
													<li>
														bare metal and why we also didn’t do that (yet???)
													</li>
												</ul>
											</li>
											<li>
												include other cameras considered from arducam + issues
												with V2
											</li>
										</ul>
									</li>
								</ul>
							</details>
						</section>

						<footer class="page__meta">
							<p class="page__date">
								<i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>

								<strong>Updated:</strong>
								<time datetime="2020-07-10">July 10, 2020</time>
							</p>
						</footer>

						<nav class="pagination">
							<a
								href="/open/cam/"
								class="pagination--pager"
								title="Camera
"
								>Previous</a
							>

							<a
								href="/open/cam/track/"
								class="pagination--pager"
								title="Tracking Algorithm
"
								>Next</a
							>
						</nav>
					</div>
				</article>
			</div>
		</div>

		<div class="search-content">
			<div class="search-content__inner-wrap">
				<form
					class="search-content__form"
					onkeydown="return event.key != 'Enter';"
				>
					<label class="sr-only" for="search">
						Enter your search term...
					</label>
					<input
						type="search"
						id="search"
						class="search-input"
						tabindex="-1"
						placeholder="Enter your search term..."
					/>
				</form>
				<div id="results" class="results"></div>
			</div>
		</div>

		<div id="footer" class="page__footer">
			<footer>
				<!-- start custom footer snippets -->

				<!-- end custom footer snippets -->
				<div class="page__footer-follow">
					<ul class="social-icons">
						<li><strong>Follow:</strong></li>

						<li>
							<a
								href="https://twitter.com/bozotics"
								rel="nofollow noopener noreferrer"
								><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i>
								Twitter</a
							>
						</li>

						<li>
							<a
								href="https://facebook.com/Bozotics-113608380186713"
								rel="nofollow noopener noreferrer"
								><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i>
								Facebook</a
							>
						</li>

						<li>
							<a
								href="https://github.com/bozotics"
								rel="nofollow noopener noreferrer"
								><i class="fab fa-fw fa-github" aria-hidden="true"></i>
								GitHub</a
							>
						</li>

						<li>
							<a
								href="https://instagram.com/bozotics"
								rel="nofollow noopener noreferrer"
								><i class="fab fa-fw fa-instagram" aria-hidden="true"></i>
								Instagram</a
							>
						</li>

						<li>
							<a href="/feed.xml"
								><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i>
								Feed</a
							>
						</li>
					</ul>
				</div>

				<div class="page__footer-copyright">
					&copy; 2020 Transcendence. Powered by
					<a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp;
					<a
						href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/"
						rel="nofollow"
						>Minimal Mistakes</a
					>.
				</div>
			</footer>
		</div>

		<script src="/assets/js/main.min.js"></script>
		<script src="https://kit.fontawesome.com/4eee35f757.js"></script>

		<script src="/assets/js/lunr/lunr.min.js"></script>
		<script src="/assets/js/lunr/lunr-store.js"></script>
		<script src="/assets/js/lunr/lunr-en.js"></script>

		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script
			async
			src="https://www.googletagmanager.com/gtag/js?id=UA-166112888-1"
		></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag("js", new Date());

			gtag("config", "UA-166112888-1", { anonymize_ip: false });
		</script>

		<aside class="sidebar__top" id="topButton">
			<a href="#top"><i class="fas fa-angle-double-up fa-2x"></i></a>
		</aside>
		<script>
			/* When the user scrolls down 100px from the top of the document, show the button */
			$(window).scroll(function () {
				if ($(this).scrollTop() >= 100) {
					$("#topButton").fadeIn(200);
				} else {
					$("#topButton").fadeOut(200);
				}
			});
		</script>
	</body>
</html>
